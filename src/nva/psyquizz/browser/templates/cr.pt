<div>
  <h1>Resultate</h1>

  <form action="." tal:attributes="action view.request.url"
	tal:define="current view.filters.get('criterias', {})">
    <dl tal:define="crits view.criterias">
      <tal:dl tal:repeat="crit crits">
	<dt><h3 tal:content="crit" /></dt>
	<dd>
	  <div tal:repeat="opt crits[crit]"
	       style="display: inline-block; padding: 5px;">
	    <input name="criterias" type="checkbox"
		   tal:attributes="value opt.uid;
				   checked opt.uid in current" />
              <span tal:content="'%s (%s)' % (opt.name, opt.amount)" />
	  </div>
	</dd>
      </tal:dl>
    </dl>
    <input type="submit" value="filter" />
  </form>

  <table class="table table-bordered">
    <tr tal:repeat="stat view.users_statistics.items()">
      <td tal:content="stat[0]"></td> 
      <td>
	<div tal:repeat="scale stat[1]">
	  <span tal:content="'%s : %s%%' % (scale.name, scale.percentage)" />
	</div>
      </td> 
    </tr>
  </table>
  
  <table>
    <tr tal:repeat="data view.statistics['global.averages']">
      <td tal:content="data.title"></td> 
      <td tal:content="data.average"></td> 
    </tr>
  </table>
  <div id="container" style="min-width: 310px; max-width: 800px; height: 400px; margin: 0 auto"></div>
  <div id="container1" style="min-width: 310px; max-width: 800px; height: 400px; margin: 0 auto"></div>
  <script>
Highcharts.chart('container', {
    chart: {
        type: 'bar'
    },
    title: {
        text: 'Stacked bar chart'
    },
    xAxis: {
        categories: <span tal:replace="view.xAxis"/> 
    },
    yAxis: {
        min: 0,
        title: {
            text: 'Total fruit consumption'
        }
    },
    legend: {
        reversed: true
    },
    plotOptions: {
        series: {
            stacking: 'normal'
        }
    },
    series: <span tal:replace="view.series"/> 
});


Highcharts.chart('container1', {

    chart: {
        polar: true,
        type: 'line'
    },

    title: {
        text: 'Budget vs spending',
        x: -80
    },

    pane: {
        size: '80%'
    },

    xAxis: {
      categories: <span tal:replace="view.xAxis"/>,
        tickmarkPlacement: 'on',
        lineWidth: 0
    },

    yAxis: {
        gridLineInterpolation: 'polygon',
        lineWidth: 0,
        tickAmount: 4,
        min: 0,
        plotBands: [
           {
            color: '#FF0000',
            from: 0,
            to:  3 
           },
           {
            color: '#FFFF00',
            from: 3,
            to: 4 
           },
           {
            color: '#32DD32',
            from: 4,
            to: 6 
           },
       ],
    },

    legend: {
        align: 'right',
        verticalAlign: 'top',
        y: 70,
        layout: 'vertical'
    },

    series: [{
        name: 'Allocated Budget',
        data: <span tal:replace="view.rd"/>,
        pointPlacement: 'on'
    }
    ]

});

  </script>
</div>
